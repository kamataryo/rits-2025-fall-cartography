---
marp: true
theme: default
class: title
paginate: true
---

<!-- _class: title -->

# MapLibre GL JS と OpenStreetMap で始める<br />ウェブカートグラフィ入門

## 第11回：応用プロジェクト（1）- 地図プロジェクトの企画

立命館大学 2025年度 秋セメスター 火曜5限
授業時間：85分

---

## 本日のアジェンダ

1. **前回の振り返り・課題確認** (10分)
2. **地図プロジェクトのテーマ選定** (25分)
3. **データの準備と設計** (25分)
4. **プロトタイプの作成** (20分)
5. **ディスカッションとフィードバック** (5分)

---

## 前回の振り返り

### 第10回の主要ポイント
- ベクトルタイルの仕組みとフォーマット（MVT、GeoJSON）
- MapLibre GL JS でのベクトルタイル利用方法
- パフォーマンス最適化技術
- 大量データの効率的な処理
- 実用的なベクトータイルサービスの活用

### 課題の確認
ベクトルタイルを使った地図アプリケーション作成
- 技術的実装の確認
- 機能性の評価
- パフォーマンス最適化の検証
- 設計・考察の質

---

## 地図プロジェクトのテーマ選定

### プロジェクトの目的

#### 学習目標
- **技術統合**：これまで学んだ技術の総合的な活用
- **問題解決**：実際の課題に対する地図ソリューション
- **創造性**：独自のアイデアと表現の実現
- **実用性**：実際に使える地図アプリケーションの作成

#### 評価の観点
- **技術的完成度**：実装の正確性と安定性
- **デザイン品質**：視覚的な美しさとユーザビリティ
- **独創性**：アイデアの新しさと工夫
- **実用性**：実際の利用価値

---

### テーマ選定の指針

#### 1. 個人の興味・関心に基づく
- **趣味・特技**：スポーツ、音楽、アート、料理など
- **専門分野**：学部・学科の専門知識
- **地域愛**：出身地・居住地への愛着
- **社会問題**：環境、福祉、教育などへの関心

#### 2. 実現可能性を考慮する
- **技術的制約**：学習した技術の範囲内
- **データ入手性**：利用可能なデータソース
- **時間的制約**：残り授業回数での完成可能性
- **複雑さ**：適切な難易度設定

---

#### 3. 独創性を重視する
- **既存サービスとの差別化**：新しい視点・アプローチ
- **ユニークな組み合わせ**：異なる要素の融合
- **個人的な体験**：自分だけの知識・経験の活用
- **地域性**：ローカルな特色の反映

#### 4. 実用性を意識する
- **ターゲットユーザー**：明確な利用者像
- **利用シーン**：具体的な使用場面
- **価値提供**：ユーザーにとってのメリット
- **継続性**：長期的な利用可能性

---

### テーマ例の紹介

#### A. 趣味・ライフスタイル系

##### 1. カフェ巡りマップ
- **概要**：個人的なカフェ体験を共有
- **特徴**：評価・レビュー・写真の統合
- **技術**：GeoJSON、カスタムアイコン、ポップアップ
- **データ**：自分で収集、OSM POI補完

##### 2. ランニング・サイクリングルート
- **概要**：運動ルートの記録・共有
- **特徴**：標高プロファイル、距離・時間計算
- **技術**：GPXデータ、ライン表示、アニメーション
- **データ**：GPS記録、地形データ

---

##### 3. 写真スポットマップ
- **概要**：撮影地点と作品の紹介
- **特徴**：写真ギャラリー、撮影情報
- **技術**：画像表示、メタデータ活用
- **データ**：EXIF情報、個人コレクション

#### B. 学術・研究系

##### 4. 歴史的建造物マップ
- **概要**：地域の文化遺産の紹介
- **特徴**：時代別表示、詳細解説
- **技術**：時系列フィルタ、3D表示
- **データ**：文化庁データ、自治体情報

---

##### 5. 環境データ可視化
- **概要**：大気質・騒音・緑地率の表示
- **特徴**：リアルタイムデータ、統計分析
- **技術**：API連携、コロプレス図
- **データ**：政府オープンデータ、センサーデータ

##### 6. 大学施設案内
- **概要**：キャンパス内の詳細ナビゲーション
- **特徴**：室内地図、リアルタイム情報
- **技術**：屋内測位、多層表示
- **データ**：大学提供データ、自作測量

---

#### C. 社会貢献系

##### 7. バリアフリーマップ
- **概要**：アクセシビリティ情報の共有
- **特徴**：段差・スロープ・エレベーター情報
- **技術**：ユーザー投稿機能、評価システム
- **データ**：クラウドソーシング、行政データ

##### 8. 災害避難支援マップ
- **概要**：緊急時の避難経路・施設案内
- **特徴**：リアルタイム情報、多言語対応
- **技術**：位置情報、プッシュ通知
- **データ**：防災データ、ハザードマップ

---

##### 9. 地域活性化マップ
- **概要**：地元商店・イベントの紹介
- **特徴**：商店街連携、イベント情報
- **技術**：CMS連携、SNS統合
- **データ**：商工会議所、イベント主催者

#### D. エンターテイメント系

##### 10. アニメ・映画ロケ地マップ
- **概要**：作品の舞台となった場所の紹介
- **特徴**：作品情報、比較画像
- **技術**：画像比較、ストリートビュー連携
- **データ**：ファンサイト、公式情報

---

### テーマ選定ワークショップ

#### ステップ1：ブレインストーミング（5分）
- 思いつくテーマを自由に書き出す
- 実現可能性は考えず、アイデアを広げる
- 最低10個のテーマを考える

#### ステップ2：評価・絞り込み（5分）
以下の観点で各テーマを評価（1-5点）
- **興味度**：自分がどれだけ興味を持てるか
- **実現可能性**：技術的・時間的制約での実現可能性
- **独創性**：他にない新しさがあるか
- **実用性**：実際に使ってもらえるか

---

#### ステップ3：最終決定（5分）
- 総合点の高いテーマを2-3個選択
- それぞれについて具体的な実装イメージを考える
- 最終的に1つのテーマに決定

#### ステップ4：テーマ発表（10分）
- 選択したテーマとその理由を発表
- 他の学生からのフィードバックを受ける
- 必要に応じてテーマを調整

---

## データの準備と設計

### データソースの分類

#### 1. オープンデータ
- **政府・自治体**：統計データ、施設情報、地理データ
- **OpenStreetMap**：地図データ、POI情報
- **研究機関**：学術データ、観測データ
- **国際機関**：グローバルデータ、標準データ

#### 2. 商用データ・API
- **地図サービス**：Google Places、Foursquare
- **SNS・レビュー**：Twitter、Instagram、Yelp
- **交通・物流**：GTFS、リアルタイム交通情報
- **気象・環境**：気象庁API、環境データ

---

#### 3. 自作・収集データ
- **フィールドワーク**：現地調査、測量
- **アンケート・インタビュー**：ユーザー調査
- **写真・動画**：視覚的コンテンツ
- **個人記録**：GPS軌跡、日記、評価

#### 4. クラウドソーシング
- **ユーザー投稿**：レビュー、写真、評価
- **コミュニティ**：Wikipedia、地域コミュニティ
- **専門家**：学芸員、研究者、愛好家
- **企業・団体**：商店、NPO、自治体

---

### データ設計の原則

#### 1. データモデルの設計
```javascript
// 例：カフェ情報のデータモデル
const cafeDataModel = {
  id: "unique_identifier",
  name: "カフェ名",
  location: {
    type: "Point",
    coordinates: [経度, 緯度]
  },
  properties: {
    category: "cafe",
    subcategory: "specialty_coffee",
    rating: 4.5,
    price_range: "$$",
    wifi: true,
    power_outlets: true,
    opening_hours: "08:00-20:00",
    website: "https://example.com",
    photos: ["photo1.jpg", "photo2.jpg"],
    reviews: [
      {
        user: "user_id",
        rating: 5,
        comment: "素晴らしいコーヒー",
        date: "2024-01-15"
      }
    ]
  }
};
```

---

#### 2. データ品質の確保
- **完全性**：必要な情報がすべて含まれている
- **正確性**：情報が正しく、最新である
- **一貫性**：データ形式・命名規則が統一されている
- **妥当性**：データが論理的に正しい

#### 3. スケーラビリティの考慮
- **データ量**：将来的な増加に対応できる構造
- **更新頻度**：リアルタイム更新の必要性
- **アクセス頻度**：高頻度アクセスへの対応
- **分散処理**：大量データの効率的な処理

---

### データ収集の実践

#### フィールドワークの計画
1. **調査範囲の設定**：地理的・時間的範囲
2. **調査項目の決定**：収集すべき情報の明確化
3. **調査方法の選択**：観察・測定・インタビュー
4. **記録方法の準備**：フォーム・アプリ・機器

#### デジタルツールの活用
- **GPS機器・アプリ**：位置情報の正確な記録
- **カメラ・スマートフォン**：視覚的記録
- **測定器具**：距離・角度・環境データ
- **調査アプリ**：KoBoToolbox、Survey123

---

#### データ統合の手法
```javascript
// 複数ソースからのデータ統合例
async function integrateData() {
  // OSMデータの取得
  const osmData = await fetchOSMData(bbox);
  
  // 政府オープンデータの取得
  const govData = await fetchGovernmentData(area);
  
  // 自作データの読み込み
  const customData = await loadCustomData();
  
  // データの統合・正規化
  const integratedData = {
    type: 'FeatureCollection',
    features: [
      ...normalizeOSMData(osmData),
      ...normalizeGovData(govData),
      ...normalizeCustomData(customData)
    ]
  };
  
  return integratedData;
}
```

---

## プロトタイプの作成

### プロトタイプの目的

#### 1. 概念実証（Proof of Concept）
- **技術的実現可能性**：選択した技術で実装可能か
- **データ可用性**：必要なデータが入手可能か
- **パフォーマンス**：想定する規模で動作するか
- **ユーザビリティ**：使いやすいインターフェースか

#### 2. 早期フィードバック
- **ユーザーテスト**：実際の利用者からの意見
- **技術レビュー**：専門家からの技術的助言
- **デザインレビュー**：視覚的・操作的な改善点
- **機能検証**：必要な機能の過不足

---

### プロトタイプの種類

#### 1. ペーパープロトタイプ
- **手描きスケッチ**：画面レイアウト・操作フロー
- **ワイヤーフレーム**：情報構造・ナビゲーション
- **ストーリーボード**：利用シナリオ・ユーザージャーニー
- **情報設計図**：データ構造・システム構成

#### 2. デジタルプロトタイプ
- **モックアップ**：静的な画面デザイン
- **インタラクティブプロトタイプ**：クリック可能なデモ
- **機能プロトタイプ**：核心機能の動作確認
- **統合プロトタイプ**：全体システムの簡易版

---

### プロトタイプ作成の手順

#### ステップ1：要件定義（10分）
```markdown
## プロジェクト要件定義書

### 基本情報
- プロジェクト名：
- 対象ユーザー：
- 利用シーン：

### 機能要件
- 必須機能：
- 推奨機能：
- 将来機能：

### 技術要件
- 使用技術：
- データソース：
- パフォーマンス要件：

### デザイン要件
- デザインコンセプト：
- カラーパレット：
- ユーザビリティ要件：
```

---

#### ステップ2：情報設計（10分）
```javascript
// データ構造の設計
const dataStructure = {
  // メインデータ
  features: [
    {
      type: 'Feature',
      geometry: {...},
      properties: {
        // 基本情報
        id: '',
        name: '',
        category: '',
        
        // 詳細情報
        description: '',
        images: [],
        rating: 0,
        
        // メタデータ
        created_at: '',
        updated_at: '',
        source: ''
      }
    }
  ],
  
  // 設定情報
  config: {
    map: {
      center: [lng, lat],
      zoom: 12,
      style: 'custom'
    },
    ui: {
      theme: 'light',
      language: 'ja'
    }
  }
};
```

---

#### ステップ3：画面設計（15分）
```html
<!-- 基本的なレイアウト構造 -->
<!DOCTYPE html>
<html>
<head>
  <title>プロジェクト名</title>
  <style>
    .container {
      display: flex;
      height: 100vh;
    }
    .sidebar {
      width: 300px;
      background: #f8f9fa;
    }
    .map-container {
      flex: 1;
    }
    .controls {
      position: absolute;
      top: 10px;
      right: 10px;
      z-index: 1000;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="sidebar">
      <!-- サイドバーコンテンツ -->
    </div>
    <div class="map-container">
      <div id="map"></div>
      <div class="controls">
        <!-- コントロールボタン -->
      </div>
    </div>
  </div>
</body>
</html>
```

---

#### ステップ4：核心機能の実装（20分）
```javascript
// 最小限の機能実装
class MapPrototype {
  constructor() {
    this.map = null;
    this.data = null;
  }
  
  async init() {
    // 地図の初期化
    this.map = new maplibregl.Map({
      container: 'map',
      style: this.getMapStyle(),
      center: [135.5, 34.7],
      zoom: 12
    });
    
    // データの読み込み
    this.data = await this.loadData();
    
    // レイヤーの追加
    this.addLayers();
    
    // イベントの設定
    this.setupEvents();
  }
  
  getMapStyle() {
    // 簡単なスタイル定義
    return {
      version: 8,
      sources: {
        'osm': {
          type: 'raster',
          tiles: ['https://tile.openstreetmap.org/{z}/{x}/{y}.png']
        }
      },
      layers: [
        {
          id: 'osm',
          type: 'raster',
          source: 'osm'
        }
      ]
    };
  }
  
  async loadData() {
    // サンプルデータまたは実データの読み込み
    return {
      type: 'FeatureCollection',
      features: [
        // サンプルデータ
      ]
    };
  }
  
  addLayers() {
    // データレイヤーの追加
    this.map.addSource('main-data', {
      type: 'geojson',
      data: this.data
    });
    
    this.map.addLayer({
      id: 'main-layer',
      type: 'circle',
      source: 'main-data',
      paint: {
        'circle-radius': 8,
        'circle-color': '#ff6b6b'
      }
    });
  }
  
  setupEvents() {
    // クリックイベント
    this.map.on('click', 'main-layer', (e) => {
      this.showPopup(e.features[0], e.lngLat);
    });
  }
  
  showPopup(feature, lngLat) {
    // ポップアップの表示
    new maplibregl.Popup()
      .setLngLat(lngLat)
      .setHTML(this.generatePopupContent(feature))
      .addTo(this.map);
  }
  
  generatePopupContent(feature) {
    const props = feature.properties;
    return `
      <div>
        <h3>${props.name}</h3>
        <p>${props.description}</p>
      </div>
    `;
  }
}

// プロトタイプの起動
const prototype = new MapPrototype();
prototype.init();
```

---

## ディスカッションとフィードバック

### プロトタイプ発表会

#### 発表形式（1人3分）
1. **テーマ紹介**（30秒）：選択理由・目的
2. **プロトタイプデモ**（2分）：実際の動作確認
3. **今後の計画**（30秒）：次回までの作業予定

#### フィードバック観点
- **アイデアの独創性**：新しさ・面白さ
- **技術的実現可能性**：現実的な実装可能性
- **ユーザビリティ**：使いやすさ・わかりやすさ
- **改善提案**：具体的な改善アイデア

---

### 相互評価とアドバイス

#### ピアレビューシート
```markdown
## プロジェクト評価シート

### 基本情報
- 発表者：
- プロジェクト名：
- テーマ：

### 評価項目（5段階評価）
- アイデアの独創性：□□□□□
- 技術的完成度：□□□□□
- デザイン品質：□□□□□
- 実用性：□□□□□

### コメント
- 良い点：
- 改善提案：
- 質問・疑問：

### 総合評価
- 総合点：___/20点
- 一言コメント：
```

---

### 次回に向けた計画立案

#### 作業計画テンプレート
```markdown
## 第12回までの作業計画

### 完成目標
- 最終的に実現したい機能・品質

### 優先順位
1. 必須実装項目：
2. 推奨実装項目：
3. 時間があれば実装項目：

### 週次計画
- 今週（第11回後）：
- 来週（第12回前）：

### 懸念事項・課題
- 技術的課題：
- データ収集課題：
- 時間的制約：

### 必要な支援
- 技術的サポート：
- データ提供：
- その他：
```

---

<div class="assignment">

## 課題：プロジェクトのテーマと概要を提出

### 課題内容
本日の授業で企画した地図プロジェクトについて、詳細な企画書を作成してください。

### 提出物

#### 1. プロジェクト企画書
- **形式**：A4用紙3-4枚程度（PDF形式）
- **内容**：
  - プロジェクト概要（テーマ・目的・対象ユーザー）
  - 機能仕様（必須機能・推奨機能・将来機能）
  - 技術仕様（使用技術・データソース・システム構成）
  - デザイン方針（コンセプト・カラーパレット・UI設計）
  - 実装計画（スケジュール・優先順位・リスク対策）
  - 期待効果（ユーザーメリット・社会的価値）

</div>

---

<div class="assignment">

#### 2. プロトタイプファイル
- **ファイル名**：`[学籍番号]_prototype.html`
- **内容**：本日作成したプロトタイプ
- **要件**：基本的な地図表示と核心機能のデモ

#### 3. データサンプル（該当する場合）
- **ファイル名**：`[学籍番号]_sample_data.geojson`
- **内容**：プロジェクトで使用予定のサンプルデータ
- **要件**：最低5-10件のサンプルレコード

### 評価基準
- **企画の独創性**（30%）：アイデアの新しさ・面白さ
- **実現可能性**（25%）：技術的・時間的制約での実現可能性
- **実用性**（20%）：実際の利用価値・社会的意義
- **計画性**（15%）：具体的で現実的な実装計画
- **プロトタイプ**（10%）：基本機能の動作確認

</div>

---

<div class="assignment">

### 提出期限・方法
- **期限**：次回授業開始時
- **方法**：学習管理システム経由

### 注意事項
- 企画書は他の学生と共有される可能性があります
- プロトタイプは次回授業で発表に使用します
- 実現困難な企画の場合は、授業時間外に相談してください

### 参考資料
- 政府統計ポータルサイト（e-Stat）
- 地理院地図・地理院タイル
- OpenStreetMap Wiki
- 各種オープンデータカタログ

</div>

---

## 次回予告

### 第12回：応用プロジェクト（2）- 地図プロジェクトの完成
- 地図デザインの最終調整
- プロジェクトの動作確認・デバッグ
- 発表準備・プレゼンテーション資料作成
- 相互レビューとフィードバック
- 最終調整とブラッシュアップ

### 準備事項
- 企画書に基づいたプロジェクトの実装
- 必要なデータの収集・整理
- 基本機能の動作確認
- 発表用の資料準備

---

## 質疑応答

### 本日の内容について
- プロジェクトテーマ選定の相談
- データ収集・準備の方法
- 技術的実装の課題
- プロトタイプ作成の支援
- 課題に関する質問

---

<!-- _class: title -->

# ありがとうございました

## 次回もよろしくお願いします

**第12回：応用プロジェクト（2）- 地図プロジェクトの完成**
[日時・教室]

課題の提出をお忘れなく！
