---
marp: true
theme: default
class: title
paginate: true
---

<script src="https://g69ye6vo2a.execute-api.ap-northeast-1.amazonaws.com/v1/client/vote-client.min.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll("section").forEach(section => {
      const reaction = document.createElement("reaction-component");
      reaction.setAttribute("emojis", "👍,👎,🤔,💡");
      section.appendChild(reaction);
    });
  });
</script>
<style>
/* ページ番号は右上。リアクションコンポーネントをおきたいので */
section.title::after { top: 21px; }
</style>

<!-- _class: title -->

# MapLibre GL JS と OpenStreetMap で始める<br />ウェブカートグラフィ入門

## 第4-5回：OpenStreetMapの実践と活用

立命館大学 2025年度 秋セメスター 火曜5限
授業時間：190分（2回分）

---

## 本日のアジェンダ

### 第4回（前半95分）
1. **前回の振り返り・課題確認** (10分)
2. **導入：Google Mapsを印刷して使って良いのか？** (15分)
3. **OpenStreetMapの基本理念とコミュニティ** (25分)
4. **OSMアカウント作成と編集体験** (45分)

### 第5回（後半95分）
1. **OSMデータの構造を実際に見てみる** (30分)
2. **Overpass Turboでデータ探索** (40分)
3. **データ品質と活用方法** (20分)
4. **課題説明** (5分)

---

## 前回の振り返り

### 第3回の主要ポイント
- GeoJSON フォーマットの理解
- GeoJSON の構造と記法（Geometry, Feature, FeatureCollection）
- 座標系と座標の順序（経度, 緯度）
- 簡単な GeoJSON ファイルの作成

---

### 課題の確認
GeoJSONファイルの作成と構造理解
- どのような発見がありましたか？
- 座標の順序で困ったことはありませんでしたか？

<vote-form vote-key="furikaeri-on-03" freetext="on" view="freeflow">

---

## 導入：Google Mapsを印刷して使って良いのか？

**これって著作権的に大丈夫？**

#### シナリオ1： 学術利用（非商用・教育目的）
- 学会発表のスライドにGoogle Mapsのスクリーンショットを使いたい
- 論文に地図を掲載したい

#### シナリオ2：商用利用

- 会社のWebサイトに地図を掲載したい
- 会社のチラシに地図を掲載したい

---

### Google Mapsの利用規約

[ガイドライン](https://about.google/brand-resource-center/products-and-services/geo-guidelines/)

- 補助的な利用（無加工・小規模・非商用・部数制限あり）ならOK。要帰属表示
- 大規模・商品化・広告のメイン要素としてはNG

---

### OpenStreetMap (選択肢の1つとして)

[https://www.openstreetmap.org/](https://www.openstreetmap.org/)

---

#### OpenStreetMapの特徴

- **完全に自由な利用**: 商用利用も無料
- **データの再配布OK**: 改変・再配布も自由
- **カスタマイズ自由**: デザインも機能も自由に変更
- **世界中のコミュニティが作成**: 継続的な更新

---

#### ライセンス：Open Database License (ODbL)

https://www.openstreetmap.org/copyright/ja

- **利用**: 自由（商用含む）
- **改変**: 自由
- **再配布**: 自由（同じライセンスで）
- **クレジット表記**: 必要（© OpenStreetMap contributors）

---

// TODO: あまり立ち入りたくない

## OpenStreetMapの基本理念とコミュニティ

### OSMの基本理念

#### 1. 地図は人類共通の財産
> 「地図データは誰でも自由に使えるべき」

- 地理情報へのアクセスは基本的権利
- 経済的制約による情報格差の解消
- 知識の民主化

---

// TODO: あまり立ち入りたくない

#### 2. 集合知の力
> 「多くの目があれば、すべてのバグは浅い」

- 世界中の人々が協力してデータを作成
- 継続的な改善とアップデート
- 地域の専門知識の活用

---

// TODO: あまり立ち入りたくない

#### 3. 地域の人が一番よく知っている
> 「その場所を最もよく知るのは、そこに住む人々」

- 現地の人による編集を重視
- 地域固有の情報の反映
- 文化的多様性の尊重

---

#### 4. 透明性と説明責任

// TODO: あまり立ち入りたくない

> 「すべての変更は記録され、公開される」

- 編集履歴の完全な記録
- 変更理由の明示
- 誰でも検証可能

---

### OSMコミュニティの現状

// TODO: イビデンス確認

#### 世界の統計（2024年現在）
- **登録ユーザー数**: 約1,000万人
- **月間アクティブユーザー**: 約100万人
- **総編集回数**: 約10億回
- **データ量**: ノード約90億個

#### 日本のコミュニティ
- **OpenStreetMap Foundation Japan**: 日本支部
- **マッピングパーティ**: 定期的な地図作成イベント
- **災害対応**: 東日本大震災、熊本地震での活用実績

---

## OSMアカウント作成と編集体験

### 実習: アカウント作成

#### 手順
1. https://www.openstreetmap.org/ にアクセス
2. 「アカウント作成」をクリック
3. 必要情報を入力。ユーザー名/メールアドレス/パスワード
4. メール認証を完了

#### 注意点

- **ユーザー名は公開される**
- **本名である必要はない**
- **メールアドレスは他のユーザーから見えない**

---

### 編集の基本：iDエディタ

#### iDエディタとは？
- **Webブラウザで動作**する編集ツール
- **初心者向け**の直感的なインターフェース
- **リアルタイム**でのデータ更新

#### 起動方法
1. [OpenStreetMap.org](https://openstreetmap.org)にログイン
2. 編集したい場所に地図を移動
3. 「編集」ボタンをクリック
4. iDエディタが起動

---

### 実習1：POI（Point of Interest）の追加

#### 目標
大学周辺の店舗や施設を追加してみる

#### 手順
1. **地図を大学周辺に移動**
2. **「ポイント」ツールを選択**
3. **追加したい場所をクリック**
4. **適切なカテゴリを選択**
   - レストラン、コンビニ、銀行など
5. **詳細情報を入力**
   - 名前、営業時間、電話番号など
6. **変更を保存**

---

### 実習2：道路情報の修正

#### 目標
歩道や小道の情報を追加・修正する

#### 手順
1. **「ライン」ツールを選択**
2. **道路の始点をクリック**
3. **道路に沿ってクリックを続ける**
4. **終点でダブルクリック**
5. **道路の種類を選択**
   - 歩道（footway）
   - 住宅街の道路（residential）
   - 小道（path）
6. **詳細情報を入力**
7. **変更を保存**

---

### 実習3：建物の輪郭を描く

#### 目標
航空写真を参考に建物の形を正確に描く

#### 手順
1. **「エリア」ツールを選択**
2. **建物の角をクリック**
3. **建物の輪郭に沿ってクリック**
4. **最初の点に戻ってクリック（閉じる）**
5. **建物の種類を選択**
   - 住宅（house）
   - 商業建物（commercial）
   - 学校（school）
6. **変更を保存**

---

### 編集のベストプラクティス

#### 編集前の確認
- **既存データをチェック**: 重複を避ける
- **航空写真を確認**: 正確な位置を把握
- **現地情報を確認**: 最新の状況を反映

#### 編集時の注意
- **適切なタグを使用**: 標準的なタグを選択
- **変更セットコメントを記入**: 何を変更したかを明記
- **段階的に編集**: 大きな変更は分割して実施

#### 保存時のポイント
- **変更内容を確認**: 意図しない変更がないかチェック
- **コメントを詳しく**: 他の編集者が理解できるように

---

# 第5回：OSMデータの構造と活用

---

## OSMデータの構造を実際に見てみる

[https://wiki.openstreetmap.org/wiki/JA:要素](https://wiki.openstreetmap.org/wiki/JA:%E8%A6%81%E7%B4%A0)

### OSMの基本要素

#### 1. ノード（Node）
- **定義**: 単一の地理的ポイント
- **構成**: ID、緯度、経度、タグ
- **用途**: 店舗、駅、交差点など

#### 実際のデータ例：大阪駅
```xml
<node id="123456" lat="34.7024" lon="135.4959">
  <tag k="name" v="大阪駅"/>
  <tag k="railway" v="station"/>
  <tag k="operator" v="JR西日本"/>
  <tag k="wheelchair" v="yes"/>
</node>
```

---

#### 2. ウェイ（Way）
- **定義**: ノードの順序付きリスト
- **用途**: 道路、建物の外形、境界線
- **種類**: 開いたウェイ（道路）、閉じたウェイ（建物）

#### 実際のデータ例：御堂筋
```xml
<way id="789012">
  <nd ref="123456"/>
  <nd ref="123457"/>
  <nd ref="123458"/>
  <tag k="highway" v="primary"/>
  <tag k="name" v="御堂筋"/>
  <tag k="lanes" v="6"/>
</way>
```

---

#### 3. リレーション（Relation）
- **定義**: ノード、ウェイ、他のリレーションの集合
- **用途**: 複雑な地理的関係の表現
- **例**: バス路線、行政境界、マルチポリゴン

#### 実際のデータ例：バス路線
```xml
<relation id="345678">
  <member type="way" ref="789012" role=""/>
  <member type="node" ref="123456" role="stop"/>
  <tag k="type" v="route"/>
  <tag k="route" v="bus"/>
  <tag k="name" v="大阪市営バス1号系統"/>
</relation>
```

// TODO: ポイント/ライン/ポリゴンよりもっとプリミティブな..
OSM は 編集可能な地理データ構造を扱うため、内部モデルとして node/way/relation を採用していることを説明したい

---

### タグシステムの実際

#### 主要なタグ体系を実データで確認

##### 道路（highway）
- `highway=motorway` → 高速道路
- `highway=primary` → 国道
- `highway=residential` → 住宅街の道路
- `highway=footway` → 歩道

##### 建物（building）
- `building=yes` → 一般的な建物
- `building=house` → 住宅
- `building=commercial` → 商業建物

##### 店舗・施設（amenity）
- `amenity=restaurant` → レストラン
- `amenity=convenience` → コンビニ
- `amenity=bank` → 銀行

---

### 実習：OpenStreetMap.orgでデータ構造を確認

#### 手順
1. **OpenStreetMap.orgにアクセス**
2. **興味のある場所を検索**
3. **地物をクリックして詳細表示**
4. **「詳細」リンクをクリック**
5. **タグ情報を確認**

#### 確認ポイント
- どのようなタグが使われているか？
- ジオメトリタイプは何か？
- 他の要素との関係は？

---

## Overpass Turboでデータ探索

### Overpass Turboとは？

#### 概要
- **OSMデータの検索・可視化ツール**
- **Webブラウザで利用可能**
- **リアルタイムデータアクセス**
- **結果の地図表示**

#### アクセス方法
- URL: https://overpass-turbo.eu/
- アカウント不要
- 日本語インターフェース対応

---

### 実習1：ウィザードを使った基本検索

#### 目標
大学周辺のコンビニを検索する

#### 手順
1. **Overpass Turboにアクセス**
2. **地図を大学周辺に移動**
3. **「ウィザード」ボタンをクリック**
4. **検索条件を入力**: `amenity=convenience`
5. **「クエリを作成して実行」をクリック**
6. **結果を地図で確認**

#### 結果の見方
- **青い点**: 検索結果
- **左パネル**: 詳細データ
- **地図上のクリック**: 個別情報表示

---

### 実習2：複合条件での検索

#### 目標
日本料理レストランのみを検索する

#### 手順
1. **「ウィザード」で基本クエリ作成**
2. **検索条件**: `amenity=restaurant and cuisine=japanese`
3. **実行して結果確認**

#### 発展：営業時間での絞り込み
```
amenity=restaurant and cuisine=japanese and opening_hours
```

---

### 実習3：距離による検索

#### 目標
特定の駅から半径500m以内の店舗を検索

#### クエリ例
```overpass
[out:json][timeout:25];
(
  node["shop"](around:500,34.7024,135.4959);
  way["shop"](around:500,34.7024,135.4959);
);
out geom;
```

#### 座標の調べ方
1. **Google Mapsで場所を右クリック**
2. **座標をコピー**
3. **緯度、経度の順番に注意**

---

### 実習4：エリア指定での検索

#### 目標
特定の市区町村内のデータを検索

#### クエリ例
```overpass
[out:json][timeout:25];
(
  area["name"="大阪市"];
)->.searchArea;
(
  node["amenity"="school"](area.searchArea);
  way["amenity"="school"](area.searchArea);
);
out geom;
```

---

### データの可視化と分析

#### 結果の見方
- **地図上の分布**: 地理的パターンの確認
- **データ一覧**: 属性情報の確認
- **統計情報**: 件数、種類別の集計

#### 分析のポイント
- **密度の違い**: 都市部と郊外の差
- **種類の偏り**: 地域特性の反映
- **データの欠損**: 情報が不足している箇所

#### GeoJSONエクスポート
1. **「エクスポート」ボタンをクリック**
2. **「GeoJSON」を選択**
3. **ファイルをダウンロード**

---

## データ品質と活用方法

### OSMデータの品質特性

#### 品質のばらつき
- **地域差**: 都市部は詳細、地方は粗い
- **分野差**: 道路は充実、建物は不完全な場合も
- **時期差**: 更新頻度の違い

#### 品質評価の観点
- **完全性**: 必要なデータがすべてあるか
- **正確性**: 位置や属性が正しいか
- **最新性**: 現実と同期しているか
- **一貫性**: タグ付けが統一されているか

---

### データ活用の実例

#### 1. 商圏分析
- **競合店舗の分布**
- **アクセス性の評価**
- **人口密度との相関**

#### 2. 都市計画
- **公共施設の配置**
- **交通アクセスの評価**
- **緑地の分布分析**

#### 3. 災害対応
- **避難経路の確認**
- **医療機関の分布**
- **インフラの被害状況**

---

### データ品質向上への貢献

#### 個人でできること
- **現地調査**: 実際に足を運んで確認
- **写真撮影**: 詳細情報の記録
- **継続的な更新**: 変化を見つけたら修正

#### コミュニティ活動
- **マッピングパーティ**: 集団での地図作成
- **品質チェック**: 他の人の編集をレビュー
- **新規参加者の支援**: 編集方法の指導

---

<div class="assignment">

## 課題：Overpass Turboを使ったデータ探索レポート

### 課題内容
Overpass Turbo（https://overpass-turbo.eu/）を使用して、興味のあるエリアの特定のテーマに関するデータを取得し、分析結果をレポートにまとめてください。

### テーマ例
- 飲食店の分布と種類分析
- 公共交通機関のアクセス状況
- 教育機関の配置パターン
- 医療機関の分布状況
- 商業施設の競合分析
- 公園・緑地の分布

</div>

---

<div class="assignment">

### 調査項目

#### 1. 調査設計（25%）
- **対象エリア**: 調査範囲の設定と選択理由
- **調査テーマ**: 選択したテーマと調査目的
- **仮説**: 事前の予想・期待する結果

#### 2. データ取得（25%）
- **使用したクエリ**: Overpass QLの内容（コピー&ペースト）
- **取得データ数**: 検索結果の件数
- **データの概要**: 主要な属性情報の整理

#### 3. 分析結果（30%）
- **地理的分布**: 空間的な特徴・パターンの発見
- **属性分析**: 種類・特性別の分類・集計
- **特徴的な発見**: 興味深い結果・予想外の傾向

</div>

---

<div class="assignment">

#### 4. 考察（20%）
- **仮説の検証**: 事前予想との比較・検討
- **地域特性**: エリア固有の特徴の考察
- **データ品質**: 不足・改善点の指摘
- **活用可能性**: 実際の用途への応用アイデア

### 提出要項
- **形式**: A4用紙3-4枚程度のレポート（PDF形式）
- **添付**: 使用したクエリ、取得データ（GeoJSON）、地図のスクリーンショット
- **提出期限**: 次回授業開始時
- **提出方法**: Manaba+R経由

### 評価のポイント
- 調査設計の妥当性と明確性
- Overpass Turboの適切な使用
- データ分析の深さと洞察
- 考察の質と実用性

</div>

---

## 次回予告

### 第6回: ウェブ地図の構成要素
- ベースマップとオーバーレイの概念
- タイルシステムの仕組み
- MapLibre GL JSの基本セットアップ
- 実際のWebページでの地図表示

### 準備事項
- 今回作成したGeoJSONデータの保存
- テキストエディタの準備
- Web開発の基本知識の復習

---

## 質疑応答

### 本日の内容について
- OpenStreetMapの編集体験はいかがでしたか？
- Overpass Turboの使用で困ったことはありませんか？
- 課題に関する質問
- 次回の内容への疑問

---

<!-- _class: title -->

# ありがとうございました

## 次回もよろしくお願いします

**第6回: ウェブ地図の構成要素**

課題の提出をお忘れなく！
OpenStreetMapへの貢献も継続してください。
